<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Korean Dummy Text Generator</title>
  <style>
    :root {
      color-scheme: light dark;
      font-family: 'Inter', 'Pretendard', 'Noto Sans KR', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      --bg: #111315;
      --panel: #1b1d20;
      --border: rgba(255, 255, 255, 0.08);
      --text: #f5f7fb;
      --text-subtle: rgba(245, 247, 251, 0.75);
      --accent: #6dd4c1;
      --accent-strong: #31b79f;
      --danger: #ff6b81;
      --muted: rgba(255, 255, 255, 0.04);
      --radius: 10px;
    }

    body {
      margin: 0;
      padding: 18px;
      background: var(--bg);
      color: var(--text);
      font-size: 13px;
      line-height: 1.6;
    }

    h1 {
      font-size: 16px;
      margin: 0 0 4px;
      font-weight: 600;
      letter-spacing: -0.01em;
    }

    p {
      margin: 0;
      color: var(--text-subtle);
    }

    section {
      margin-top: 16px;
      padding: 14px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--panel);
    }

    .selection-state {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
      font-size: 12px;
    }

    .selection-pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--muted);
    }

    fieldset {
      border: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 10px;
    }

    label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--text-subtle);
    }

    select,
    input,
    textarea {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--muted);
      color: var(--text);
      font-size: 12px;
      font-family: inherit;
      transition: border 0.15s ease;
    }

    select:focus,
    input:focus,
    textarea:focus {
      border-color: var(--accent);
      outline: none;
    }

    textarea {
      min-height: 140px;
      resize: vertical;
      background: rgba(0, 0, 0, 0.3);
    }

    .grid {
      display: grid;
      gap: 12px;
    }

    .grid.two {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .grid.three {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    .pill-options {
      display: flex;
      gap: 8px;
    }

    .pill-options label {
      text-transform: none;
      letter-spacing: normal;
      font-size: 12px;
      cursor: pointer;
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 6px 12px;
      background: var(--muted);
      color: var(--text);
      user-select: none;
      transition: background 0.15s ease, border-color 0.15s ease;
    }

    .pill-options input {
      display: none;
    }

    .pill-options input:checked+span {
      background: rgba(109, 212, 193, 0.2);
      border-color: var(--accent);
      color: var(--accent);
    }

    button {
      border: none;
      border-radius: 8px;
      padding: 10px 12px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: transform 0.1s ease, opacity 0.15s ease;
    }

    button:active {
      transform: translateY(1px);
    }

    .primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color: #0c100f;
    }

    .ghost {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text-subtle);
    }

    .toolbar {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .preview-header span {
      font-size: 11px;
      letter-spacing: 0.08em;
      color: var(--text-subtle);
    }

    .stats {
      font-size: 11px;
      color: var(--text-subtle);
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
    }

    .status-message {
      margin-top: 10px;
      font-size: 12px;
      color: var(--text-subtle);
      min-height: 18px;
    }

    .status-message.success {
      color: var(--accent);
    }

    .status-message.error {
      color: var(--danger);
    }
  </style>
</head>

<body>
  <header>
    <h1>한글 더미 텍스트</h1>
    <p>톤과 밀도를 고르면 자연스러운 문단을 만들어 드립니다.</p>
  </header>

  <section class="selection-state">
    <div>
      <strong>선택 상태</strong>
      <div id="selectionSummary" class="selection-pill">선택된 레이어 없음</div>
    </div>
    <button class="ghost" id="refreshButton">↻</button>
  </section>

  <section>
    <fieldset class="grid">
      <div class="grid two">
        <div>
          <label for="toneSelect">톤</label>
          <select id="toneSelect">
            <option value="neutral">잔잔한 균형</option>
            <option value="friendly">부드러운 대화</option>
            <option value="technical">기술 중심</option>
          </select>
        </div>
        <div>
          <label for="modeSelect">형식</label>
          <select id="modeSelect">
            <option value="paragraphs">문단</option>
            <option value="sentences">문장</option>
          </select>
        </div>
      </div>

      <div class="grid two">
        <div>
          <label for="countInput">개수</label>
          <input id="countInput" type="number" min="1" max="6" value="2" />
        </div>
        <div>
          <label for="densitySelect">밀도</label>
          <select id="densitySelect">
            <option value="light">가볍게</option>
            <option value="medium" selected>보통</option>
            <option value="dense">풍부하게</option>
          </select>
        </div>
      </div>

      <div>
        <label>헤딩 추가</label>
        <div class="pill-options">
          <label>
            <input type="radio" name="heading" value="none" checked />
            <span>없음</span>
          </label>
          <label>
            <input type="radio" name="heading" value="single" />
            <span>한 줄</span>
          </label>
        </div>
      </div>
    </fieldset>

    <div class="toolbar">
      <button type="button" class="ghost" id="copyButton">복사</button>
      <button type="button" class="ghost" id="regenerateButton">새로고침</button>
    </div>

    <div class="preview-header">
      <span>미리보기</span>
      <span id="selectionCount"></span>
    </div>
    <textarea id="previewField" readonly></textarea>
    <div class="stats">
      <span id="charCount">0자</span>
      <span id="paragraphCount">0개</span>
    </div>
  </section>

  <section>
    <button class="primary" id="fillSelectionButton">선택된 텍스트 채우기</button>
    <button class="ghost" id="newLayerButton" style="margin-top:10px;">새 텍스트 레이어 만들기</button>
    <div class="status-message" id="statusMessage"></div>
  </section>

  <script>
    const TEXT_BANK = {
      neutral: [
        '햇살이 커튼 사이로 번져 사무실 공기를 부드럽게 데웠다.',
        '잔잔한 빗소리가 창가를 타고 흐르며 오후의 리듬을 만들었다.',
        '차분한 회색이 배경을 지키자 포인트 색상이 한층 또렷해졌다.',
        '자연스러운 간격이 문단의 호흡을 살려 준다.',
        '텁텁한 공기 대신 달큼한 원두 향이 공간을 채웠다.',
        '서랍을 정리하듯 생각도 하나씩 제자리를 찾았다.',
        '초점이 맞춰지는 순간 흐릿했던 계획이 선명해졌다.',
        '느리지만 꾸준히 쌓인 기록이 브랜드의 신뢰가 된다.',
        '부드러운 파스텔 톤이 화면 전반의 긴장을 풀어준다.'
      ],
      friendly: [
        '파도 같은 알림창이 잠시 쉬어 가도 괜찮다.',
        '금요일 오후엔 회의 대신 라떼 한 잔이 어울린다.',
        '말랑한 쿠션처럼 텍스트도 여백을 만나 부드러워진다.',
        '팀 채팅창에 올라온 이모지가 공기를 살짝 밝힌다.',
        '살랑이는 배경음악이 집중 모드를 부드럽게 돕는다.',
        '점심 약속이 있는 날엔 오전 시간이 순식간에 지나간다.',
        '사용자도 편하고 디자이너도 행복한 화면이 베스트다.',
        '질끈 묶은 머리를 푸는 순간 아이디어가 퐁 하고 떠올랐다.'
      ],
      technical: [
        '데이터 계층은 느슨한 결합을 유지하며 상태를 전달한다.',
        '토큰 시스템을 쓰면 색과 서체가 한 번에 정리된다.',
        '캐시 만료 정책을 명확히 해야 일관된 응답 시간을 보장한다.',
        '다크 모드 대비 비율은 최소 4.5:1을 지켜야 한다.',
        '마이크로 인터랙션은 프레임 전환 시간을 체감적으로 줄인다.',
        'API 스키마가 안정되면 문서화 속도도 자연스레 붙는다.',
        '접근성 감사 로그는 구성 요소 수준에서 남겨 둬야 한다.',
        '그리드 단위가 일정해야 반응형 레이아웃이 깔끔해진다.',
        '프로토타입 단계에서도 실제 데이터 형태를 미리 확인한다.'
      ]
    };

    const HEADING_BANK = {
      neutral: ['잔잔하게 정리된 하루', '차분한 톤의 리듬'],
      friendly: ['가벼운 인사말', '포근한 한 줄 소개'],
      technical: ['시스템 노트', '설계 개요']
    };

    const DENSITY_PRESETS = {
      light: { min: 2, max: 3 },
      medium: { min: 3, max: 4 },
      dense: { min: 5, max: 6 }
    };

    let currentText = '';

    const elements = {
      tone: document.getElementById('toneSelect'),
      mode: document.getElementById('modeSelect'),
      count: document.getElementById('countInput'),
      density: document.getElementById('densitySelect'),
      headingRadios: document.querySelectorAll('input[name="heading"]'),
      preview: document.getElementById('previewField'),
      charCount: document.getElementById('charCount'),
      paragraphCount: document.getElementById('paragraphCount'),
      selectionSummary: document.getElementById('selectionSummary'),
      selectionCount: document.getElementById('selectionCount'),
      statusMessage: document.getElementById('statusMessage')
    };

    document.getElementById('regenerateButton').addEventListener('click', () => {
      updatePreview();
    });

    document.getElementById('refreshButton').addEventListener('click', () => {
      parent.postMessage({ pluginMessage: { type: 'ui-ready' } }, '*');
    });

    document.getElementById('copyButton').addEventListener('click', async () => {
      if (!currentText) return;
      try {
        await navigator.clipboard.writeText(currentText);
        flashStatus('클립보드에 복사했습니다.', 'success');
      } catch {
        flashStatus('복사에 실패했습니다.', 'error');
      }
    });

    document.getElementById('fillSelectionButton').addEventListener('click', () => {
      ensurePreview();
      parent.postMessage({ pluginMessage: { type: 'apply-text', payload: { text: currentText, strategy: 'selection' } } }, '*');
    });

    document.getElementById('newLayerButton').addEventListener('click', () => {
      ensurePreview();
      parent.postMessage({ pluginMessage: { type: 'apply-text', payload: { text: currentText, strategy: 'new' } } }, '*');
    });

    document.querySelectorAll('#toneSelect, #modeSelect, #countInput, #densitySelect, input[name="heading"]').forEach((el) => {
      el.addEventListener('change', () => updatePreview());
    });

    function ensurePreview() {
      if (!currentText.trim()) {
        updatePreview();
      }
    }

    function updatePreview() {
      const request = getCurrentOptions();
      currentText = generateText(request);
      elements.preview.value = currentText;
      const paragraphs = request.mode === 'paragraphs' ? request.count : Math.max(1, currentText.split('\n\n').length);
      const charLength = currentText.replace(/\s+/g, '').length;
      elements.charCount.textContent = `${charLength}자`;
      elements.paragraphCount.textContent = `${paragraphs}개 ${request.mode === 'paragraphs' ? '문단' : '문장'}`;
    }

    function getCurrentOptions() {
      const headingValue = Array.from(elements.headingRadios).find((radio) => radio.checked)?.value ?? 'none';
      return {
        tone: elements.tone.value,
        mode: elements.mode.value,
        count: clamp(parseInt(elements.count.value, 10) || 1, 1, 6),
        density: elements.density.value,
        heading: headingValue
      };
    }

    function generateText({ tone, mode, count, density, heading }) {
      const bank = TEXT_BANK[tone] || TEXT_BANK.neutral;
      const range = DENSITY_PRESETS[density] || DENSITY_PRESETS.medium;
      const paragraphs = [];

      if (heading === 'single') {
        const headingLine = pickRandom(HEADING_BANK[tone] || HEADING_BANK.neutral);
        paragraphs.push(`◦ ${headingLine}`);
      }

      if (mode === 'sentences') {
        for (let i = 0; i < count; i++) {
          paragraphs.push(pickRandom(bank));
        }
      } else {
        for (let i = 0; i < count; i++) {
          const sentences = [];
          const sentenceCount = randomInt(range.min, range.max);
          for (let j = 0; j < sentenceCount; j++) {
            sentences.push(pickRandom(bank));
          }
          paragraphs.push(sentences.join(' '));
        }
      }

      return paragraphs.join('\n\n');
    }

    function clamp(value, min, max) {
      return Math.max(min, Math.min(max, value));
    }

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function pickRandom(list = []) {
      if (!list.length) return '';
      const index = Math.floor(Math.random() * list.length);
      return list[index];
    }

    function flashStatus(message, variant = '') {
      elements.statusMessage.textContent = message;
      elements.statusMessage.className = `status-message ${variant}`;
      setTimeout(() => {
        elements.statusMessage.textContent = '';
        elements.statusMessage.className = 'status-message';
      }, 2500);
    }

    window.onmessage = (event) => {
      const { type, payload } = event.data.pluginMessage || {};
      if (type === 'selection-update') {
        const { textLayers, totalLayers } = payload;
        const label = textLayers > 0
          ? `텍스트 ${textLayers} / 전체 ${totalLayers}`
          : '선택된 텍스트 레이어 없음';
        elements.selectionSummary.textContent = label;
        elements.selectionCount.textContent = textLayers > 0 ? `${textLayers}개 선택` : '';
      }

      if (type === 'apply-result') {
        if (payload.status === 'ok') {
          flashStatus('텍스트 적용 완료!', 'success');
        } else {
          flashStatus('적용에 실패했습니다.', 'error');
        }
      }
    };

    // 초기화
    updatePreview();
    parent.postMessage({ pluginMessage: { type: 'ui-ready' } }, '*');
  </script>
</body>

</html>
